[meta]
title = "Ruby Live Text-to-Speech"
description = "Get started using Deepgram's Live Text-to-Speech with this Ruby demo app"
author = "Deepgram DX Team <devrel@deepgram.com> (https://developers.deepgram.com)"
repository = "https://github.com/deepgram-starters/ruby-live-text-to-speech"
useCase = "live-text-to-speech"
language = "ruby"
framework = "sinatra"
tags = ["live-text-to-speech", "live-tts", "streaming-tts", "real-time-tts", "streaming-text-to-speech", "ruby", "sinatra"]

# Check prerequisites
[check]
command = ["git --version", "ruby --version", "bundle --version"]
message = "All prerequisites installed"

# Install dependencies
[install.pre]
command = "git submodule update --init --recursive"
message = "Submodules initialized"

[install]
command = ["bundle install", "cd frontend && corepack pnpm install"]
message = "Dependencies installed"

[install.post]
command = "test -f .env || cp sample.env .env"
message = "Environment configuration ready"

[install.config]
sample = "sample.env"
output = ".env"

# Start application
[start.pre]
command = "test -f .env || (echo '‚ùå .env not found. Run: cp sample.env .env' && exit 1)"
message = "Environment validated"

[start]
command = ["bundle exec rackup config.ru -p 8081 -o 0.0.0.0", "cd frontend && corepack pnpm run dev -- --port 8080 --no-open"]
parallel = true
message = "Application running on http://localhost:8080"

# Update submodules
[update]
command = "git submodule update --remote --merge"
message = "Submodules updated"

# Clean artifacts
[clean]
command = ["rm -rf vendor/bundle", "rm -rf frontend/node_modules", "rm -rf frontend/.vite"]
message = "Build artifacts cleaned"

[test]
command = "cd contracts && ./tests/run-live-text-to-speech-app.sh"
message = "Tests complete"

# Eject frontend and contracts submodules for standalone development
[eject-frontend]
command = "make eject-frontend"
message = "Frontend ejected successfully"
